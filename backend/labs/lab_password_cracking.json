{
  "id": "lab_password_cracking",
  "title": "Password Hash Cracking",
  "description": "Learn fundamental password cracking techniques using hashcat and wordlists. Understand why strong passwords matter.",
  "difficulty": "Intermediate",
  "duration": "25 min",
  "category": "Cryptography",
  "semester_level": 2,
  "scenario": "During a penetration test, you've extracted password hashes from a compromised database. Your task is to crack these hashes to demonstrate the risk of weak passwords.",
  "environment": "terminal",
  "tasks": [
    {
      "step": 1,
      "title": "Identify Hash Type",
      "instruction": "You have a hash file. First, identify the hash type using hashid.",
      "hint": "Use hashid with the hash string",
      "expected_command": "hashid '5f4dcc3b5aa765d61d8327deb882cf99'",
      "output": "Analyzing '5f4dcc3b5aa765d61d8327deb882cf99'\n[+] MD5\n[+] MD4\n[+] MD2\n[+] NTLM\n[+] Domain Cached Credentials",
      "explanation": "The hash is most likely MD5 (32 hex characters). MD5 is an insecure hashing algorithm."
    },
    {
      "step": 2,
      "title": "Prepare Hash File",
      "instruction": "Create a file containing the hash to crack.",
      "hint": "Use echo to write the hash to a file",
      "expected_command": "echo '5f4dcc3b5aa765d61d8327deb882cf99' > hash.txt",
      "output": "",
      "explanation": "Hash saved to file. Now we can use cracking tools on it."
    },
    {
      "step": 3,
      "title": "Dictionary Attack",
      "instruction": "Use hashcat to perform a dictionary attack with the rockyou wordlist.",
      "hint": "Use hashcat with mode 0 for MD5 and specify the wordlist",
      "expected_command": "hashcat -m 0 hash.txt /usr/share/wordlists/rockyou.txt",
      "output": "hashcat (v6.2.6) starting\n\nHost memory required for this attack: 1 MB\n\nDictionary cache built:\n* Filename: /usr/share/wordlists/rockyou.txt\n* Passwords: 14344392\n* Bytes: 139921507\n\n5f4dcc3b5aa765d61d8327deb882cf99:password\n\nSession..........: hashcat\nStatus...........: Cracked\nHash.Mode........: 0 (MD5)\nTime.Started.....: Sat Nov 22 10:30:00 2024\nTime.Estimated...: Sat Nov 22 10:30:01 2024\nGuess.Queue......: 1/1 (100.00%)\nSpeed.#1.........: 2451.2 kH/s (0.12ms)\nRecovered........: 1/1 (100.00%) Digests",
      "explanation": "Cracked! The password was 'password' - found instantly because it's in common wordlists."
    },
    {
      "step": 4,
      "title": "Crack Stronger Hash",
      "instruction": "Now try cracking a SHA-256 hash with a rule-based attack. The hash is for a modified common password.",
      "hint": "Use mode 1400 for SHA-256 with rules",
      "expected_command": "hashcat -m 1400 -r /usr/share/hashcat/rules/best64.rule sha256.txt /usr/share/wordlists/rockyou.txt",
      "output": "hashcat (v6.2.6) starting\n\na665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3:123456789\n\nSession..........: hashcat\nStatus...........: Cracked\nHash.Mode........: 1400 (SHA2-256)\nTime.Started.....: Sat Nov 22 10:35:00 2024\nTime.Estimated...: Sat Nov 22 10:35:45 2024\nSpeed.#1.........: 892.3 kH/s (4.23ms)\nRecovered........: 1/1 (100.00%) Digests\n\nFLAG{ISC_HASH_CRACKER_PRO_2024}",
      "explanation": "Success! Even SHA-256 can be cracked if the password is weak. Always use strong, unique passwords!",
      "flag": "FLAG{ISC_HASH_CRACKER_PRO_2024}"
    }
  ]
}
